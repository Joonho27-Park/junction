# Junction TODOs

## 정리
* x 모듈 리팩토링 (ui, model, analysis)
* x 최종 사용자 문서 (README.md)
* x 웹 페이지

* 코드 주석 문서화
* 사용자 테스트
* 뷰포트/캔버스 플로팅 재작성 (addLine 등을 래핑한 함수가 있는 캔버스 객체)
* 모든 안전하지 않은 / imgui 래핑

## 사소한 것들
* x junction으로 이름 변경
* x 단축키 (저장, 로드)
* x 설정/색상 저장/로드
* x 더 나은 색상 기본값
*   폰트+크기 변경
*   .junc 확장자로 저장/로드

*   디스패치를 열고 닫을 때 뷰(중앙/줌)가 더 잘 보존됨
*   폴리라인 열차 (그리고 선로, tvd 구간?)

## 인프라 모델 + 시뮬레이션
* 더 많은 객체들
  * 탈선기?
  * X 사전 신호 (편집기 + 시뮬레이터)
  * atc? 또는 더 낮은 수준의 것
         또는 rep.balise만
  * ertms?
  * 구체적인 디스패치를 위한 열차 시작 속도
  * 속도 표지 / 제한

* 마일리지 역방향 감지 / 수정
* X 실행 취소 분류 (과도한 실행 취소 방지)
* 선로 길이
* 노드/객체의 마일리지
* 객체의 위치
* 신호 시야 거리 지정, 마주보는 스위치로 인해 달성할 수 없는 경우 경고
* 기울기 (반지름?)

* X "확장" 경계 노드 시 모델의 노드 참조 이름 변경
* X 객체 이동 시 모델의 객체 참조 이름 변경.

*   열린 끝 -> 모델 경계로 이름 변경

## 연동
* 검사 가능한 연동
* 구성 가능한 연동
* 데이터로그 기반 연동?
* 중복
* 측면 보호

## 디스패치
* X 더 나은 디스패치 표현
* X 디스패치 편집

* 자동 디스패치/운행/제약 기반 열차
 * X 계획 데이터 구조
 * X 인프라 + 디스패치 메뉴에서 새 계획 추가
 * X 새 열차 추가, 열차를 행으로 표시
 * X 인프라 컨텍스트 메뉴에서 열차에 새 방문 추가
 * X 방문 재배열, 방문 병합, 방문 분할
 * X 제약 추가
 * X 제약별 토포 정렬 뷰
 * X 제약 그리기
 * X 버그: 한 열차에서 다른 열차로 방문 이동 시 VisitKey 무효화
 * X 제약 삭제
 * x 열차 삭제
 * X 계획과 디스패치 삭제
 * X 열차, 디스패치, 계획 이름 변경
 *   잘못된 제약 금지, 방문 재배열 시 작동하지 않는 제약 삭제
 * x 인프라에서 방문 위치 강조
 * X 방문 유형: 경계 vs 중간
 *   체류 시간
 *   제약 최대 시간 차이

* X 디스패치/자동 디스패치용 gui

*   수동으로 자동 디스패치 복사

## railml

* railml 2.x 가져오기
  * 개략적 구성
  * X  선로 변환
  *    객체 변환

* railml 2.x nor 가져오기?
* railml 3 가져오기
* railml 2.x 내보내기
* railml 2.x nor 내보내기
* railml 3 내보내기


## 개략적
* 전체 모델 자동 레이아웃
* 선택 항목 자동 레이아웃
* 주어진 마일리지/위치/고정 기호로


## 테스트

* 코드 테스트
* gui 테스트, 스크린샷 포함?


## 합성

* X 전체 역 개념 증명
* 제안 개념 증명
* 선택으로 제한


## 정적 분석

* 오류 창의 데이터로그 속성


## 버그
* X 수동 디스패치 생성을 실행 취소할 수 있지만 여전히 표시되고 새 명령 추가 시 충돌.
*   여러 속성이 있는 합성이 작동하지 않음?


# 파일 형식

* 정의된, 버전 관리된 파일 형식
* json/cbor 직렬화 사용 시 이전 버전과의 호환성을 어떻게 처리할까?




# 2019-08-27 사용자 테스트에서 발견된 문제들

최우선 순위
 * 계획: 신호 등에 대한 방문이 구현되지 않음
 * ESC 키로 팝업 메뉴 닫기
 * 계획에서 디스패치를 정렬하여 사소한 변경을 통해 안정적으로 만들기
 * 제약 추가 -> 그 다음 위치 클릭 실패 (위치가 버튼이기 때문?)
 * 파일 로드 실패 시 오류 메시지 표시 (오류 메시지 벡터 만들기)
 * 합성 예제 실패 (탐지기 제거가 문제일 수 있음)
 * 모든 삭제 버튼 (편집 메뉴바)
 * 창 최소화 시 애플리케이션 충돌

중간 우선순위
 * 사용자가 인프라 컨텍스트 메뉴가 열려있는 동안 뷰를 팬하고 싶어함
 * 디스패치 뷰의 명령에서 박스 크기가 실제 그립 크기가 아님
 * 디스패치에서 명령을 강조할 때 신호뿐만 아니라 전체 경로도 강조
 * 새 차량의 이름이 기본 차량과 동일함
 * 차량 창 하단의 차량 추가 버튼이 창에서 변경사항을 저장하기 위해 클릭이 필요하다는 인상을 줄 수 있음
 * 디스패치 드롭다운 메뉴는 (자동 추가) 또는 (수동 추가) 클릭 시 닫혀야 함
 * 디스패치 재생 목록 (모든 디스패치 실행)
 * 계획: 위치가 버튼처럼 보이지만 버튼이 아님
 * 계획: t1: a-> b->, t2: b<-, a<- 마지막 두 개에만 제약이 있는 경우 강제로 교차하지만 아마도 그렇게 해서는 안 됨.
 * 다른 이름으로 저장 유형: \*.junc


낮은 우선순위
 * 열차를 폴리라인으로 그리기
 * (아마도) 인프라에서 신호에 마우스를 올릴 때 해당 신호에서 시작하는 경로 강조

